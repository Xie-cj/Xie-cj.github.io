/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /gh/tangkaichuan/gridea-search@undefined/lib/gridea-search.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(){function e(){var e=function(e,t){if(e.indexOf("?")>-1)for(var n=e.split("?")[1].split("&"),s=n.length-1;s>=0;s--){var o=n[s].split("=");if(o[0]===t)return o[1]}}(window.location.href,"q");return decodeURIComponent(e.replace(/\+/g," "))}function t(e){var t=new XMLHttpRequest;t.open("get",e.url,!0),t.send(null),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?e.success(t.responseText):e.error(t.status))}}function n(){var e={};if((e.infos=JSON.parse(localStorage.getItem("InfosCache")),e.contents=JSON.parse(localStorage.getItem("ContentsCache")),e.infos&&e.contents)&&e.infos.utils.now.toString()===document.getElementById("gridea-search-form").getAttribute("data-update"))return e;return localStorage.removeItem("InfosCache"),localStorage.removeItem("ContentsCache"),!1}function s(e,s){var o="";!function(e){var s=n();s?e(s.contents):t({url:"/api-content/index.html",success:function(t){e(JSON.parse(t)),localStorage.setItem("ContentsCache",t)}})}(function(t){o=function(e,t){return new Fuse(e,{includeMatches:!0,distance:1e4,keys:["title","content"]}).search(t)}(t.posts,e),s(o)})}function o(){var e=document.getElementById("gridea-search-result"),t=e.getElementsByClassName("no-result")[0];t.style.display="block",e.innerHTML=t.outerHTML}function r(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++)if("text/ejs"===e[t].type)return e[t].src}function a(e){for(var t=e.item.content,n="",s=0;s<e.matches.length;s++)if("content"===e.matches[s].key){var o=e.matches[s].indices[0];n=t.substring(o[0]-10,o[0])+'<span class="searched-keyword">'+t.substring(o[0],o[1]+1)+"</span>"+t.substring(o[1]+1,o[1]+70)}else n=t.substring(0,80);return n+"..."}function c(){!function(t){var n=e();""===n||void 0===n?o():s(n,t)}(function(e){var s,c;s=function(n){!function(e){e.posts.length>0?t({url:r(),success:function(t){document.getElementById("gridea-search-result").innerHTML=ejs.compile(t)(e)}}):o()}(function(e,t){var n=JSON.parse(JSON.stringify(e));n.posts=[];for(var s=0;s<t.length;s++)for(var o=0;o<e.posts.length;o++)t[s].item.link===e.posts[o].link&&(e.posts[o].searchedPreview=a(t[s]),e.posts[o].content=t[s].item.content,n.posts.push(e.posts[o]));return n}(n,e))},(c=n())?s(c.infos):t({url:"/api-info/index.html",success:function(e){s(JSON.parse(e)),localStorage.setItem("InfosCache",e)}})})}window.onload=function(){document.getElementById("gridea-search-form").getElementsByTagName("input")[0].value=e(),c()}}();
//# sourceMappingURL=/sm/89b132cb3f46edd27c26c567e56b871b3e83cba7c05af2633cea81c03e21f5aa.map